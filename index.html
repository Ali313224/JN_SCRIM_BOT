<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>لوحة مشرفي سكرمات ببجي</title>
<style>
  /* ألوان داكنة */
  body {
    background-color: #121212;
    color: #cfcfcf;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    padding: 0;
  }
  header {
    text-align: center;
    padding: 20px 10px 10px;
  }
  header img {
    max-width: 180px;
    height: auto;
  }
  main {
    max-width: 600px;
    margin: 10px auto 60px;
    padding: 20px;
    background-color: #1f1f1f;
    border-radius: 10px;
  }
  h2 {
    color: #7fff7f;
    margin-bottom: 10px;
    text-align: center;
  }
  label {
    display: block;
    margin: 12px 0 6px;
  }
  input[type="password"],
  input[type="text"],
  input[type="datetime-local"],
  select {
    width: 100%;
    padding: 8px;
    background-color: #222;
    border: 1px solid #555;
    border-radius: 5px;
    color: #eee;
  }
  button {
    margin-top: 15px;
    width: 100%;
    padding: 10px;
    background-color: #27ae60;
    border: none;
    border-radius: 7px;
    color: white;
    font-weight: bold;
    cursor: pointer;
  }
  button:hover {
    background-color: #3cd671;
  }
  .link-button {
    background: none;
    border: none;
    color: #3cd671;
    cursor: pointer;
    text-decoration: underline;
    padding: 0;
    font-size: 1em;
    margin-top: 10px;
  }
  .hidden {
    display: none;
  }
  .footer {
    text-align: center;
    padding: 10px;
    color: #555;
    font-size: 0.85em;
    position: fixed;
    bottom: 0;
    width: 100%;
    background-color: #121212;
  }
  .footer a {
    color: #3cd671;
    margin: 0 8px;
    text-decoration: none;
  }
  .footer a:hover {
    text-decoration: underline;
  }
  .team-member {
    margin-bottom: 12px;
    border-bottom: 1px solid #333;
    padding-bottom: 8px;
  }
  select.role-select {
    width: 100%;
    margin-top: 4px;
    background-color: #222;
    color: #eee;
    border-radius: 5px;
    border: 1px solid #555;
    padding: 5px;
  }
  /* تنسيق التذكير */
  .reminder-settings {
    margin-top: 12px;
    border: 1px solid #555;
    padding: 10px;
    border-radius: 6px;
  }
  .reminder-settings label {
    display: inline-block;
    margin: 4px 10px 0 0;
    cursor: pointer;
  }
</style>
</head>
<body>

<header>
  <img src="https://i.ibb.co/vqJrbCx/logo.png" alt="ELYA AI Logo" />
</header>

<main>

  <!-- صفحة تسجيل الدخول -->
  <section id="login-section">
    <h2>تسجيل الدخول كمشرف</h2>
    <input type="password" id="login-password" placeholder="أدخل كلمة المرور" />
    <button onclick="login()">دخول</button>
    <button class="link-button" onclick="showResetSection()">إعادة تعيين كلمة المرور</button>
    <p id="login-error" style="color:#ff5555; display:none;"></p>
  </section>

  <!-- صفحة إعادة تعيين كلمة السر -->
  <section id="reset-section" class="hidden">
    <h2>إعادة تعيين كلمة المرور</h2>
    <input type="password" id="old-password" placeholder="كلمة المرور القديمة" />
    <input type="password" id="new-password" placeholder="كلمة المرور الجديدة" />
    <input type="password" id="confirm-password" placeholder="تأكيد كلمة المرور الجديدة" />
    <button onclick="resetPassword()">حفظ التغييرات</button>
    <button class="link-button" onclick="showLoginSection()">عودة لتسجيل الدخول</button>
    <p id="reset-error" style="color:#ff5555; display:none;"></p>
    <p id="reset-success" style="color:#7fff7f; display:none;"></p>
  </section>

  <!-- الصفحة الرئيسية لتسجيل السكرمات -->
  <section id="main-section" class="hidden">
    <h2>تسجيل السكرم</h2>

    <label for="team-count">عدد الفرق في السكرم:</label>
    <select id="team-count" onchange="renderTeamMembers()">
      <option value="1">1 فريق (4 لاعبين)</option>
      <option value="2">2 فريق (8 لاعبين)</option>
      <option value="4">4 فرق (16 لاعب)</option>
    </select>

    <label for="scrim-name">اسم الفريق (اسم السكرم):</label>
    <input type="text" id="scrim-name" placeholder="مثال: فريق النصر" />

    <label for="scrim-date">موعد السكرم:</label>
    <input type="datetime-local" id="scrim-date" />

    <label for="captain-name">اسم قائد السكرم:</label>
    <input type="text" id="captain-name" placeholder="اسم قائد الفريق" />

    <div id="teams-container"></div>

    <div class="reminder-settings">
      <p><strong>خيارات التذكير قبل السكرم:</strong></p>
      <label><input type="checkbox" class="reminder" value="10" /> قبل 10 دقائق</label>
      <label><input type="checkbox" class="reminder" value="20" /> قبل 20 دقيقة</label>
      <label><input type="checkbox" class="reminder" value="30" /> قبل 30 دقيقة</label>
      <label><input type="checkbox" class="reminder" value="60" /> قبل 60 دقيقة</label>
    </div>

    <button onclick="sendToDiscord()">إرسال إلى ديسكورد</button>
    <p id="send-status" style="margin-top:10px;"></p>
  </section>

</main>

<footer class="footer">
  <a href="https://www.facebook.com/share/19HRdFsc5x/" target="_blank">فيسبوك</a> |
  <a href="https://www.instagram.com/elya_m_313/profilecard/?igsh=YmU2aTVxNHhhdjJt" target="_blank">إنستغرام</a>
  <br />
  لقد تمت برمجة هذا الموقع بواسطة Ali_Shams_313
</footer>

<script>
  // كلمة المرور الافتراضية (يمكن تعديلها أو جعلها محفوظة في localStorage)
  const STORAGE_KEY = 'pubg_scrim_password';
  if (!localStorage.getItem(STORAGE_KEY)) {
    localStorage.setItem(STORAGE_KEY, 'ELYA_ADMIN_313');
  }

  // ديسكورد ويب هوك
  const DISCORD_WEBHOOK_URL = "https://discord.com/api/webhooks/1382440597331382272/JtIYPKvhXMsLtHDzDhFVZ4QbNUG2P5NscLSi7WqohLBxy-1k7YsSRUtoppC5DwiA6IxJ";

  // قائمة الأعضاء جاهزة مع أسمائهم وID ديسكورد
  const MEMBERS = [
    { id: "1380981046362898474", name: "فايروس" },
    { id: "1360200583675379865", name: "هيثم" },
    { id: "1148152210430107708", name: "هيرو" },
    { id: "1375364456036433920", name: "سبيد" },
    { id: "1380867027367100506", name: "هنتر" },
    { id: "1370551180073107536", name: "باترو" },
    { id: "1381387460222652558", name: "روليكس" },
    { id: "1043393234245787658", name: "انس" },
    { id: "1198320840912146542", name: "ناروتو" },
    { id: "1291829284825993359", name: "زومبي" },
    { id: "1323720388521230447", name: "ماتريكس" },
  ];

  // أدوار السكريم المعروفة
  const ROLES = ["IGL", "Support", "Entry", "Lurker", "Sniper", "Coach", "Leader"];

  // DOM Elements
  const loginSection = document.getElementById("login-section");
  const resetSection = document.getElementById("reset-section");
  const mainSection = document.getElementById("main-section");

  const loginError = document.getElementById("login-error");
  const resetError = document.getElementById("reset-error");
  const resetSuccess = document.getElementById("reset-success");
  const sendStatus = document.getElementById("send-status");

  function showLoginSection() {
    loginSection.classList.remove("hidden");
    resetSection.classList.add("hidden");
    mainSection.classList.add("hidden");
    clearMessages();
  }

  function showResetSection() {
    loginSection.classList.add("hidden");
    resetSection.classList.remove("hidden");
    mainSection.classList.add("hidden");
    clearMessages();
  }

  function showMainSection() {
    loginSection.classList.add("hidden");
    resetSection.classList.add("hidden");
    mainSection.classList.remove("hidden");
    clearMessages();
    renderTeamMembers();
  }

  function clearMessages() {
    loginError.style.display = "none";
    resetError.style.display = "none";
    resetSuccess.style.display = "none";
    sendStatus.textContent = "";
  }

  // تسجيل الدخول
  function login() {
    clearMessages();
    const pw = document.getElementById("login-password").value;
    if (!pw) {
      loginError.textContent = "الرجاء إدخال كلمة المرور";
      loginError.style.display = "block";
      return;
    }
    const storedPw = localStorage.getItem(STORAGE_KEY);
    if (pw === storedPw) {
      showMainSection();
    } else {
      loginError.textContent = "كلمة المرور غير صحيحة";
      loginError.style.display = "block";
    }
  }

  // إعادة تعيين كلمة المرور
  function resetPassword() {
    clearMessages();
    const oldPw = document.getElementById("old-password").value;
    const newPw = document.getElementById("new-password").value;
    const confirmPw = document.getElementById("confirm-password").value;
    const storedPw = localStorage.getItem(STORAGE_KEY);

    if (!oldPw || !newPw || !confirmPw) {
      resetError.textContent = "الرجاء ملء جميع الحقول";
      resetError.style.display = "block";
      return;
    }
    if (oldPw !== storedPw) {
      resetError.textContent = "كلمة المرور القديمة غير صحيحة";
      resetError.style.display = "block";
      return;
    }
    if (newPw !== confirmPw) {
      resetError.textContent = "كلمة المرور الجديدة وتأكيدها غير متطابقين";
      resetError.style.display = "block";
      return;
    }
    if (newPw.length < 6) {
      resetError.textContent = "يجب أن تكون كلمة المرور الجديدة 6 أحرف على الأقل";
      resetError.style.display = "block";
      return;
    }
    localStorage.setItem(STORAGE_KEY, newPw);
    resetSuccess.textContent = "تم تغيير كلمة المرور بنجاح!";
    resetSuccess.style.display = "block";
    // بعد 2 ثانية ارجع لتسجيل الدخول تلقائياً
    setTimeout(() => {
      showLoginSection();
    }, 2000);
  }

  // إنشاء حقول الفريق حسب عدد الفرق المختار
  function renderTeamMembers() {
    const container = document.getElementById("teams-container");
    container.innerHTML = "";
    const teamCount = parseInt(document.getElementById("team-count").value);
    const playersPerTeam = 4;

    for (let team = 1; team <= teamCount; team++) {
      const teamDiv = document.createElement("div");
      teamDiv.style.border = "1px solid #3cd671";
      teamDiv.style.borderRadius = "10px";
      teamDiv.style.padding = "12px";
      teamDiv.style.marginBottom = "15px";
      teamDiv.innerHTML = `<h3 style="color:#3cd671; margin-bottom:10px;">الفريق ${team}</h3>`;
      for (let player = 1; player <= playersPerTeam; player++) {
        const memberDiv = document.createElement("div");
        memberDiv.className = "team-member";

        // خيارات أسماء الأعضاء + إمكانية إضافة ID يدوي
        let optionsHTML = MEMBERS.map(m => `<option value="${m.id}">${m.name}</option>`).join("");
        memberDiv.innerHTML = `
          <label>العضو ${player}:</label>
          <select class="member-select" data-team="${team}" data-player="${player}">
            <option value="">اختر اسم العضو</option>
            ${optionsHTML}
            <option value="manual">أدخل ID يدوي</option>
          </select>
          <input type="text" class="manual-id hidden" placeholder="أدخل معرف الديسكورد" data-team="${team}" data-player="${player}" />
          <label>الدور:</label>
          <select class="role-select">
            ${ROLES.map(role => `<option value="${role}">${role}</option>`).join("")}
          </select>
        `;
        teamDiv.appendChild(memberDiv);
      }
      container.appendChild(teamDiv);
    }

    // إضافة مستمع تغيير لقائمة الأعضاء لعرض أو إخفاء خانة إدخال ID يدوي
    document.querySelectorAll(".member-select").forEach(select => {
      select.addEventListener("change", function () {
        const manualInput = this.parentElement.querySelector(".manual-id");
        if (this.value === "manual") {
          manualInput.classList.remove("hidden");
          manualInput.focus();
        } else {
          manualInput.classList.add("hidden");
          manualInput.value = "";
        }
      });
    });
  }

  // إرسال رسالة إلى Discord Webhook
  async function sendToDiscord() {
    sendStatus.textContent = "";
    const scrimName = document.getElementById("scrim-name").value.trim();
    const scrimDateInput = document.getElementById("scrim-date").value;
    const captainName = document.getElementById("captain-name").value.trim();
    const teamCount = parseInt(document.getElementById("team-count").value);

    if (!scrimName || !scrimDateInput || !captainName) {
      sendStatus.style.color = "red";
      sendStatus.textContent = "يرجى ملء جميع الحقول الأساسية.";
      return;
    }

    const scrimDate = new Date(scrimDateInput);
    if (isNaN(scrimDate.getTime())) {
      sendStatus.style.color = "red";
      sendStatus.textContent = "الرجاء إدخال تاريخ ووقت صحيحين.";
      return;
    }

    // جمع التذكيرات
    const reminders = Array.from(document.querySelectorAll(".reminder:checked")).map(cb => parseInt(cb.value));

    // تجميع بيانات الفرق
    let content = `**📢 إعلان سكرم PUBG**\n**اسم السكرم:** ${scrimName}\n**موعد السكرم:** <t:${Math.floor(scrimDate.getTime()/1000)}:F>\n**قائد السكرم:** ${captainName}\n**عدد الفرق:** ${teamCount}\n\n`;

    for (let team = 1; team <= teamCount; team++) {
      content += `**⚔️ الفريق ${team}:**\n`;
      // إيجاد عناصر الفريق
      const members = Array.from(document.querySelectorAll(`.member-select[data-team="${team}"]`));
      const roles = Array.from(document.querySelectorAll(`#teams-container .team-member:nth-child(${(team-1)*4+1}), #teams-container .team-member:nth-child(${(team-1)*4+2}), #teams-container .team-member:nth-child(${(team-1)*4+3}), #teams-container .team-member:nth-child(${(team-1)*4+4})`));

      for (let i = 0; i < 4; i++) {
        const memberSelect = members[i];
        const manualInput = memberSelect.parentElement.querySelector(".manual-id");
        const roleSelect = memberSelect.parentElement.querySelector(".role-select");

        let mentionText = "";
        if (memberSelect.value === "manual" && manualInput.value.trim() !== "") {
          mentionText
